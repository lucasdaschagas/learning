/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2019 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
(function(d){d.pkg("s7sdk.video");d.Util.require("s7sdk.event.Event");d.Util.require("s7sdk.video.VideoProxies");d.Util.require("s7sdk.video.VideoPlayer");d.Util.require("s7sdk.video.SmartCropPoiLoader");if(!d.video.playbackType){d.video.playbackType={AUTO:"auto",HLS:"hls",DASH:"dash",PROGRESSIVE:"progressive",NATIVE:"native",FLASH:"flash"}}if(!d.video.SmartCropVideoPlayerControl){d.video.SmartCropVideoPlayerControl=function(e){arguments.callee.superclass.apply(this,[e,d.video.SmartCropVideoPlayerControl.NS,e.constructor,d.video.SmartCropVideoPlayer.RESTRICTED_STYLES]);delete this.dynamicModifiers["posterimage"]};d.video.SmartCropVideoPlayerControl.NS="s7sdk.video.SmartCropVideoPlayerControl";d.video.SmartCropVideoPlayerControl.prototype.setModifier=function(e){var g,n,h;for(var l in e){var j=l.toLowerCase();if(j=="caption"){n=e[l];if(n){var f,m=true;h=this.component.caption.file+","+(this.component.enableCaptions?"1":"0");var o=n.split(",");if(o&&o.length>0){f=o[0];if(o.length>1){m=parseInt(o[1])!=0}if(f&&f.length>0){this.component.setCaption(f,m);this.dispatchEvent(new d.event.ControlComponentEvent(d.event.ControlComponentEvent.NOTF_CONTROLCOMPONENT_MODIFIERUPDATED,{"id":this.component.getId(),oldvalue:h,newvalue:f+","+(m?"1":"0"),property:j},false))}else{this.component.setCaptionEnabled(false)}}this.dynamicModifiers.set(j,n)}}else{if(j=="mutevolume"){n=e[l];if(n){this.component.mute()}else{this.component.unmute()}}else{if(!g){g={}}g[l]=e[l]}}}if(g){this.superclass.prototype.setModifier.apply(this,[g])}};d.video.SmartCropVideoPlayerControl.prototype.rebuild=function(u){if(this.component){var f=this.component.getVolume();var s=this.component.muted();var h=this.component.viewReadyEventSent;var o=this.component.metadataReadyEventSent;var q=this.component.assetSpecificPosterImage;var p=u["posterimage"];u["posterimage"]=p?p:this.component.posterimage;var k=u["asset"];var e=u["video"];var m;var n=this.component.getCurrentAsset()?true:false;if(k){m=k;delete u["asset"];h=false;o=false;n=true}else{if(e){m=e;delete u["video"];h=false;o=false;n=false}else{if(n){m=this.component.getCurrentAsset()}else{m=this.component.getCurrentVideo()}}}var t,r,g;if((typeof this.component.getWidth=="function")&&(typeof this.component.getHeight=="function")){t=this.component.getWidth();r=this.component.getHeight()}var l,j;if(this.restrictedStylesValues[this.getCl()]){l=this.restrictedStylesValues[this.getCl()].width;j=this.restrictedStylesValues[this.getCl()].height}this.listenerProxy=d.Util.copyListeners(this.component);this.unload();this.component=new this.componentconstructor(this.parentId,u,this.compId,true);this.component.allowInitialUserEvent=false;this.restrictedStylesValues=this.readRestrictedStylesValues();var i=false;if(l&&j&&this.restrictedStylesValues[this.getCl()]){i=(l!=this.restrictedStylesValues[this.getCl()].width);i=i||(j!=this.restrictedStylesValues[this.getCl()].height)}if(!i&&(typeof this.component.resize=="function")){this.component.resize(t,r)}d.Util.assignListeners(this.listenerProxy,this.component);delete u["posterimage"];if(this.component.assetSpecificPosterImage){q=this.component.assetSpecificPosterImage}else{if(p&&p.toLowerCase()=="none"){q=undefined}}if(n){this.component.setCurrentAsset(m,q)}else{this.component.setCurrentVideo(m,q)}this.component.setVolume(f);if(s){this.component.mute()}else{this.component.unmute()}this.component.viewReadyEventSent=h;this.component.metadataReadyEventSent=o}}}d.Class.inherits(d.video.SmartCropVideoPlayerControl.NS,"s7sdk.ControlComponent");if(!d.video.SmartCropVideoPlayer){d.video.SmartCropVideoPlayer=function SmartCropVideoPlayer(e,g,f){var h=!!arguments[3];arguments.callee.superclass.apply(this,[e,g,f,true]);this.compId=(d.Util.isNull(f)?"":f);if(!h){return new d.video.SmartCropVideoPlayerControl(this)}else{return this}};d.Class.inherits("s7sdk.video.SmartCropVideoPlayer","s7sdk.video.VideoPlayer");d.video.SmartCropVideoPlayer.prototype.symbols={ERROR:"Your Browser does not support HTML5 Video tag or the video cannot be played."};d.video.SmartCropVideoPlayer.prototype.getCssClassName=function(){return"s7smartcropvideoplayer"};d.video.SmartCropVideoPlayer.prototype.addEventListener=function(g,f,e){this.superclass.superclass.prototype.addEventListener.apply(this,[g,f,e])};d.video.SmartCropVideoPlayer.prototype.setModifier=function(e){throw new Error("Trying to use setModifier on the Core class (SmartCropVideoPlayer) is unsupported! Please refer to SDK documentation on using setModifier.")};d.video.SmartCropVideoPlayer.prototype.modifiers={serverUrl:{params:["isRootPath"],defaults:["/is/image/"]},videoServerUrl:{params:["value"],defaults:["/is/content/"]},contentUrl:{params:["value"],defaults:["/is/content/"]},size:{params:["width","height"],defaults:[0,0],ranges:["0:","0:"]},asset:{params:["value"],defaults:[""]},autoplay:{params:["enabled"],defaults:[true]},singleclick:{params:["singleclick"],defaults:["playPause"],ranges:[["none","playPause"]]},posterimage:{params:["posterimage"],defaults:[""]},iconEffect:{params:["enabled","count","fade","autoHide"],defaults:[true,1,0.3,3],ranges:[null,"-1:","0:","0:"]},playback:{params:["type","controls"],defaults:[d.video.playbackType.AUTO,false],ranges:[[d.video.playbackType.AUTO,d.video.playbackType.HLS,d.video.playbackType.DASH,d.video.playbackType.PROGRESSIVE,d.video.playbackType.NATIVE,d.video.playbackType.FLASH]]},progressivebitrate:{params:["value"],defaults:[700],ranges:["1:"]},caption:{params:["file","enabled"],defaults:["",false]},initialbitrate:{params:["value"],defaults:[0],ranges:["0:"]},aemmode:{params:["value"],defaults:[false],ranges:[[true,false]]},loop:{params:["enabled"],defaults:[false]},video:{params:["value"],defaults:[""],parseParams:false},ssl:{params:["value"],defaults:["auto"],ranges:[["auto","on"]],deprecated:true},waiticon:{params:["enabled"],defaults:[true]},preload:{params:["enabled"],defaults:[true]},mutevolume:{params:["enabled"],defaults:[false],ranges:[[true,false]]},scpois:{params:["value"],defaults:[""],parseParams:false},scmode:{params:["value"],defaults:["auto"],ranges:[["auto","off"]]},scdebug:{params:["value"],defaults:[false],ranges:[[true,false]]}};d.video.SmartCropVideoPlayer.RESTRICTED_STYLES={"s7smartcropvideoplayer":["width","height"],"s7smartcropvideoplayer s7iconeffect":["width","height"]};d.video.SmartCropVideoPlayer.prototype.completePlayer=function(){if(this.scdebug){this.overlay=document.createElement("div");this.overlay.style.width="50px";this.overlay.style.height="50px";this.overlay.className="s7smartcropoverlay";this.obj.appendChild(this.overlay);this.poiMarker=document.createElement("div");this.poiMarker.className="s7smartcroppoimarker";this.obj.appendChild(this.poiMarker)}this.superclass.prototype.completePlayer.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.dispose=function(){this.superclass.prototype.dispose.apply(this,[]);if(this.obj){if(this.obj.parentElement){this.obj.parentElement.removeChild(this.obj)}}};d.video.SmartCropVideoPlayer.prototype.cleanUp=function(){if(this.overlay){this.obj.removeChild(this.overlay);this.overlay=null}if(this.poiMarker){this.obj.removeChild(this.poiMarker);this.poiMarker=null}this.superclass.prototype.cleanUp.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.setNavigationAndInteractiveData=function(){};d.video.SmartCropVideoPlayer.prototype.setAsset=function(f,e){this.superclass.prototype.setAsset.apply(this,[f,e])};d.video.SmartCropVideoPlayer.prototype.setVideo=function(f,e){this.superclass.prototype.setVideo.apply(this,[f,e])};d.video.SmartCropVideoPlayer.prototype.resize=function(e,f){this.superclass.prototype.resize.apply(this,[e,f])};d.video.SmartCropVideoPlayer.prototype.supportsInline=function(){return this.superclass.prototype.supportsInline.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.getAsset=function(){return this.superclass.prototype.getAsset.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.setCaption=function(e){this.superclass.prototype.setCaption.apply(this,[e])};d.video.SmartCropVideoPlayer.prototype.setCaptionEnabled=function(e){this.superclass.prototype.setCaptionEnabled.apply(this,[e])};d.video.SmartCropVideoPlayer.prototype.getCaptionEnabled=function(){return this.superclass.prototype.getCaptionEnabled.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.setItem=function(e){this.superclass.prototype.setItem.apply(this,[e])};d.video.SmartCropVideoPlayer.prototype.getVolume=function(){return this.superclass.prototype.getVolume.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.setVolume=function(e){this.superclass.prototype.setVolume.apply(this,[e])};d.video.SmartCropVideoPlayer.prototype.getCurrentTime=function(){return this.superclass.prototype.getCurrentTime.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.getLoadedPosition=function(){this.superclass.prototype.getLoadedPosition.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.getDuration=function(){return this.superclass.prototype.getDuration.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.getCapabilityState=function(){return this.superclass.prototype.getCapabilityState.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.ended=function(){return this.superclass.prototype.ended.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.play=function(){this.superclass.prototype.play.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.pause=function(){this.superclass.prototype.pause.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.stop=function(){this.superclass.prototype.stop.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.togglePause=function(){this.superclass.prototype.togglePause.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.seek=function(e){this.superclass.prototype.seek.apply(this,[e])};d.video.SmartCropVideoPlayer.prototype.muted=function(){return this.superclass.prototype.muted.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.mute=function(){this.superclass.prototype.mute.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.unmute=function(){this.superclass.prototype.unmute.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.supportsVolumeControl=function(){return this.superclass.prototype.supportsVolumeControl.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.setCSS=function(g,f,e){this.superclass.prototype.setCSS.apply(this,[g,f,e])};d.video.SmartCropVideoPlayer.prototype.getWidth=function(){return this.superclass.prototype.getWidth.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.getHeight=function(){return this.superclass.prototype.getHeight.apply(this,[])};d.video.SmartCropVideoPlayer.prototype.prepareVideoProxy=function(f){var g=this.superclass.prototype.prepareVideoProxy.apply(this,[f]);var e=new d.video.SmartCropVideoProxy(g,this.overlay,this.poiMarker,(this.scpois!=""?this.scpois.split(","):null),this.scmode,this.scdebug,this.contentUrl);return e};d.video.SmartCropVideoPlayer.prototype.resetQosMetric=function(){return this.superclass.prototype.resetQosMetric.apply(this,[])};(function b(){var h=d.Util.css.createCssRuleText;var g=d.Util.css.createCssImgUrlText;var f=d.browser&&d.browser.name=="ie"&&d.browser.version.major>=10;var e=h(".s7smartcropvideoplayer",{"position":"absolute","overflow":"hidden","width":"400px","height":"300px","background-color":"#000000","-webkit-touch-callout":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","touch-action":f?"none":""})+h(".s7smartcropvideoplayer div[role='button']",{"position":"relative","z-index":"1"})+h(".s7smartcropvideoplayer .s7iconeffect",{"width":"120px","height":"120px","-webkit-transform":"translateZ(0px)","background-repeat":"no-repeat","background-position":"center"})+h(".s7smartcropvideoplayer .s7iconeffect[state='play']",{"background-image":g("videoplayicon.png")})+h(".s7smartcropvideoplayer .s7iconeffect[state='replay']",{"background-image":g("videoreplayicon.png")})+h(".s7smartcropvideoplayer .s7videoposter",{"top":"0px","left":"0px","position":"absolute","background-repeat":"no-repeat","background-position":"center center","background-size":"contain"})+h(".s7smartcropvideoplayer .s7caption",{"font-family":"sans-serif","font-size":"large","color":"#ffffff","-webkit-transform":"translateZ(0px)","margin":"0 auto"})+h(".s7smartcropvideoplayer .s7waiticon",{"background-image":g("busyicon.gif"),"background-repeat":"no-repeat","background-position":"center","position":"absolute","width":"101px","height":"29px","left":"50%","top":"50%","margin-left":"-50px","margin-top":"-15px"})+((d.browser.device.name=="android")?h(".s7smartcropvideoplayer .s7videoelement",{"-webkit-clip-path":"inset(0%)","clip-path":"inset(0%)","transition":"transform 0.25s linear","will-change":"transform"}):h(".s7smartcropvideoplayer .s7videoelement",{"transition":"transform 0.25s linear"}))+h(".s7smartcropvideoplayer .s7smartcropoverlay",{"background":"rgba(255,0,0,0.5)","transition":"left 0.25s linear","position":"absolute"})+h(".s7smartcropvideoplayer .s7smartcroppoimarker",{"background":"green","transition":"left 0.25s linear","width":"1px","height":"100%","position":"absolute"});d.Util.css.addDefaultCSS(e,"SmartCropVideoPlayer")})()}if(!d.video.SmartCropVideoProxy){d.video.SmartCropVideoProxy=function c(l,i,h,j,k,g,f){arguments.callee.superclass.apply(this,[l]);this.track=null;this.overlay=i;this.poiMarker=h;this.availableAspectDefs=[];this.mode=k;this.debug=g;this.needToTransforming=this.videoProxy.autoPlay||false;this.contentUrl=f;this.vttReady=false;this.videoReady=false;this.viewReadyCallbackTriggered=false;this.ratioBBoxMap={};this.aspectDef=this.findAspectRatioDef();this.croppedVideoContentRect={x:0,y:0,width:0,height:0};this.videoElementRect={x:0,y:0,width:0,height:0};this.videoElementScl=0;var e=this;this.videoProxy.onLoadProgress=function(){e.onLoadProgress()};this.poiUrls=j};d.Class.inherits("s7sdk.video.SmartCropVideoProxy","s7sdk.video.VideoProxyAdapter");d.video.SmartCropVideoProxy.prototype.loadVtts=function(f){if(this.poiLoader){this.poiLoader.dispose()}this.poiLoader=new d.video.PoiLoader();var e=this;this.poiLoader.onLoad=function(g){e.scpoisData=e.mergePoiData(g);e.createTrack();var h=e.getVideoElement().textTracks[0];e.updateByTrackCue(h.cues[0])};this.poiLoader.onError=function(){e.vttReady=true;if(!e.viewReadyCallbackTriggered&&e.videoReady){e.onViewReady();e.viewReadyCallbackTriggered=true}e.updateCrops()};this.poiLoader.load(f)};d.video.SmartCropVideoProxy.prototype.createVideoElement=function(){this.videoProxy.createVideoElement();this.resize(this.videoProxy.getWidth(),this.videoProxy.getHeight())};d.video.SmartCropVideoProxy.prototype.updateByTrackCue=function(e){if(e&&e.text){this.ratioBBoxMap=JSON.parse(e.text);for(var f in this.ratioBBoxMap){this.checkAddAvailableAspect(f)}this.updateCrops(!this.needToTransforming);this.updateOverlays()}};d.video.SmartCropVideoProxy.prototype.setAsset=function(l,e){var f=false;var h=false;var j=[];if(l.vtts&&l.vtts.length>0){for(var g=0;g<l.vtts.length;g++){if(l.vtts[g].poiData){j.push(l.vtts[g].poiData);h=true}}}if(h&&!this.poiUrls){this.scpoisData=this.mergePoiData(j);this.createTrack();var m=this.getVideoElement().textTracks[0];this.updateByTrackCue(m.cues[0])}else{if(!this.poiUrls&&(l.vtts&&l.vtts.length>0)){var k=[];for(var g=0;g<l.vtts.length;g++){k.push(d.Util.resolveURL(this.contentUrl,l.vtts[g].id))}f=true;this.loadVtts(k)}else{if(this.poiUrls){f=true;this.loadVtts(this.poiUrls)}else{this.vttReady=true}}}if(f){this.getVideoContainer().style.visibility="hidden"}this.videoProxy.setAsset(l,e)};d.video.SmartCropVideoProxy.prototype.setVideo=function(f,e){this.videoProxy.setVideo(f,e);if(this.poiUrls){this.loadVtts(this.poiUrls)}else{this.vttReady=true}};d.video.SmartCropVideoProxy.prototype.play=function(){this.needToTransforming=true;this.videoProxy.play()};d.video.SmartCropVideoProxy.prototype.createTrack=function(){if(this.scpoisData){this.track=this.getVideoElement().addTextTrack("metadata");for(var f=0;f<this.scpoisData.length;f++){this.track.addCue(d.browser.name=="ie"?new TextTrackCue(this.scpoisData[f].start,this.scpoisData[f].end,JSON.stringify(this.scpoisData[f].crops)):new VTTCue(this.scpoisData[f].start,this.scpoisData[f].end,JSON.stringify(this.scpoisData[f].crops)))}this.vttReady=true;this.getVideoContainer().style.visibility="";if(!this.viewReadyCallbackTriggered&&this.videoReady){this.onViewReady();this.viewReadyCallbackTriggered=true}var e=this;this.getVideoElement().textTracks[0].oncuechange=function(){e.updateByTrackCue(this.activeCues[0])};this.timeUpdateHandler=function(g){if((e.getDuration()-e.getCurrentTime())<250||e.getCurrentTime()<250){e.needToTransforming=false}else{e.needToTransforming=true}};this.getVideoElement().addEventListener("timeupdate",this.timeUpdateHandler)}};d.video.SmartCropVideoProxy.prototype.resize=function(e,f){this.videoProxy.resize(e,f);if(this.videoProxy.proxyIsReady){this.updateCrops(true);this.updateOverlays()}};d.video.SmartCropVideoProxy.prototype.updateCrops=function(i){var e=this.aspectDef;this.aspectDef=this.findAspectRatioDef();var f=i||false;var h=this.getVideoContainer();h.style.visibility="";if((this.aspectDef==null)||(this.mode=="off")){this.videoElementScl=Math.min(this.getWidth()/this.getVideoWidth(),this.getHeight()/this.getVideoHeight());this.videoElementRect={width:this.getVideoWidth()*this.videoElementScl,height:this.getVideoHeight()*this.videoElementScl};this.videoElementRect.x=(this.getWidth()-this.videoElementRect.width)/2;this.videoElementRect.y=(this.getHeight()-this.videoElementRect.height)/2}else{if((e!=null)&&((e.width!=this.aspectDef.width)||(e.height!=this.aspectDef.height))){f=true}if(e==null){f=true}var g=this.getCurrentBBox();this.croppedVideoContentRect={x:this.getVideoWidth()*g.x,y:this.getVideoHeight()*g.y,width:this.getVideoWidth()*g.w,height:this.getVideoHeight()*g.h};this.croppedVideoContentRect.x=Math.max(this.croppedVideoContentRect.x,0);this.croppedVideoContentRect.y=Math.max(this.croppedVideoContentRect.y,0);this.croppedVideoContentRect.x=Math.min(this.croppedVideoContentRect.x,this.getVideoWidth()-this.croppedVideoContentRect.width);this.croppedVideoContentRect.y=Math.min(this.croppedVideoContentRect.y,this.getVideoHeight()-this.croppedVideoContentRect.height);this.videoElementScl=Math.min(this.getWidth()/this.croppedVideoContentRect.width,this.getHeight()/this.croppedVideoContentRect.height);this.videoElementRect={width:this.getVideoWidth()*this.videoElementScl,height:this.getVideoHeight()*this.videoElementScl};this.videoElementRect.x=(this.getWidth()-this.croppedVideoContentRect.width*this.videoElementScl)/2-this.croppedVideoContentRect.x*this.videoElementScl;this.videoElementRect.y=(this.getHeight()-this.croppedVideoContentRect.height*this.videoElementScl)/2-this.croppedVideoContentRect.y*this.videoElementScl;if(this.videoElementRect.width<this.getWidth()){this.videoElementRect.x=(this.getWidth()-this.videoElementRect.width)/2}else{this.videoElementRect.x=Math.max(this.videoElementRect.x,this.getWidth()-this.videoElementRect.width);this.videoElementRect.x=Math.min(this.videoElementRect.x,0)}if(this.videoElementRect.height<this.getHeight()){this.videoElementRect.y=(this.getHeight()-this.videoElementRect.height)/2}else{this.videoElementRect.y=Math.max(this.videoElementRect.y,this.getHeight()-this.videoElementRect.height);this.videoElementRect.y=Math.min(this.videoElementRect.y,0)}}if(f){h.style.transition="none";if(this.debug){this.overlay.style.transition="none";this.poiMarker.style.transition="none"}}else{h.style.transition="";if(this.debug){this.overlay.style.transition="";this.poiMarker.style.transition=""}}if(!this.needToTransforming){h.style.transform="";h.style.left=this.videoElementRect.x+"px";h.style.top=this.videoElementRect.y+"px"}else{h.style.transform="translate("+(this.videoElementRect.x-h.offsetLeft)+"px,"+(this.videoElementRect.y-h.offsetTop)+"px)"}h.style.width=this.videoElementRect.width+"px";h.style.height=this.videoElementRect.height+"px"};d.video.SmartCropVideoProxy.prototype.updateOverlays=function(){if(this.debug){var e=this.getCurrentBBox();if(e!=null){d.Logger.log(d.Logger.FINE,"video content size: "+this.getVideoWidth()+", "+this.getVideoHeight());this.overlay.style.left=(this.videoElementRect.x+this.videoElementScl*this.croppedVideoContentRect.x)+"px";this.overlay.style.top=(this.videoElementRect.y+this.videoElementScl*this.croppedVideoContentRect.y)+"px";this.overlay.style.width=this.videoElementScl*this.croppedVideoContentRect.width+"px";this.overlay.style.height=this.videoElementScl*this.croppedVideoContentRect.height+"px";this.poiMarker.style.left=(this.videoElementRect.x+(e.x+e.w/2)*this.videoElementRect.width)+"px"}}};d.video.SmartCropVideoProxy.prototype.getCurrentBBox=function(){if(this.aspectDef!=null){return this.ratioBBoxMap[this.aspectDef.width+":"+this.aspectDef.height]}else{return null}};d.video.SmartCropVideoProxy.prototype.findAspectRatioDef=function(){var f=this.getWidth()/this.getHeight();var e=-1;var h=null;for(var g=0;g<this.availableAspectDefs.length;g++){var j=Math.abs(f-this.availableAspectDefs[g].width/this.availableAspectDefs[g].height);if((h==null)||(j<e)){e=j;h=this.availableAspectDefs[g]}}return h};d.video.SmartCropVideoProxy.prototype.isAspectDefAvailable=function(f){for(var e=0;e<this.availableAspectDefs.length;e++){if((this.availableAspectDefs[e].width==f.width)&&(this.availableAspectDefs[e].height==f.height)){return true}}return false};d.video.SmartCropVideoProxy.prototype.checkAddAvailableAspect=function(f){var e={width:parseInt(f.split(":")[0]),height:parseInt(f.split(":")[1])};if(!this.isAspectDefAvailable(e)){this.availableAspectDefs.push(e);this.dumpAvailableAspects()}};d.video.SmartCropVideoProxy.prototype.dumpAvailableAspects=function(){d.Logger.log(d.Logger.FINE,"============== available aspects:");this.availableAspectDefs.forEach(function(e){d.Logger.log(d.Logger.FINE,e.width+":"+e.height)})};d.video.SmartCropVideoProxy.prototype.dispose=function(){this.getVideoElement().removeEventListener("timeupdate",this.timeUpdateHandler);if(this.poiLoader){this.poiLoader.dispose()}this.superclass.prototype.dispose.apply(this)};d.video.SmartCropVideoProxy.prototype.mergePoiData=function(n){var q=n.length;var o=0;var e=0;var v=[];var s=[];function r(j,i){if(j>i){return 1}if(j==i){return 0}if(j<i){return -1}}if(q<1){return}for(var p=0;p<q;p++){for(var l=0;l<n[p].length;l++){if(n[p][l].start<=o){o=n[p][l].start}if(n[p][l].end>=e){e=n[p][l].end}if(v.indexOf(n[p][l].start)==-1){v.push(n[p][l].start)}if(v.indexOf(n[p][l].end)==-1){v.push(n[p][l].end)}}}v=v.sort(r);for(var p=0;p<v.length-1;p++){s.push({start:v[p],end:v[p+1],crops:null})}for(var p=0;p<q;p++){var g=[];for(var l=0;l<n[p].length;l++){for(var h=0;h<s.length;h++){if(n[p][l].start<=s[h].start&&n[p][l].end>=s[h].end){g.push({start:s[h].start,end:s[h].end,crops:n[p][l].crops})}}}n[p]=[];for(var f=0;f<g.length;f++){n[p].push(g[f])}}for(var h=0;h<s.length;h++){var u={};for(var p=0;p<q;p++){for(var t in n[p][h].crops){u[t]=n[p][h].crops[t]}}s[h].crops=u}this.poisData=s;return this.poisData}}if(!d.video.VideoProxyAdapter){d.video.VideoProxyAdapter=function a(f){this.videoProxy=f;var e=this;this.videoProxy.onLoadProgress=function(){e.onLoadProgress()};this.videoProxy.onCurrentTime=function(){e.onCurrentTime()};this.videoProxy.onDuration=function(){e.onDuration()};this.videoProxy.onVideoDimension=function(){e.onVideoDimension()};this.videoProxy.onSeeked=function(){e.onSeeked()};this.videoProxy.onVolume=function(){e.onVolume()};this.videoProxy.onStateChange=function(){e.onStateChange()};this.videoProxy.onBuffering=function(){e.onBuffering()};this.videoProxy.onViewReady=function(){e.videoReady=true;if(!e.viewReadyCallbackTriggered&&e.vttReady){e.onViewReady();e.viewReadyCallbackTriggered=true}};this.videoProxy.onPlaybackError=function(g){e.onPlaybackError(g)};this.videoProxy.onQualityChange=function(g){e.onQualityChange(g)}};d.video.VideoProxyAdapter.prototype.createVideoElement=function(){this.videoProxy.createVideoElement()};d.video.VideoProxyAdapter.prototype.resolvePosterUrl=function(f,g,e,i,h){return this.videoProxy.resolvePosterUrl(f,g,e,i,h)};d.video.VideoProxyAdapter.prototype.getDurationFromItem=function(e){return this.videoProxy.getDurationFromItem(e)};d.video.VideoProxyAdapter.prototype.getVideoElement=function(){return this.videoProxy.getVideoElement()};d.video.VideoProxyAdapter.prototype.getVideoContainer=function(){var f=this.videoProxy.getVideoElement();var e=f.parentElement;if(!e||!e.classList.contains("video-js")){e=f}return e};d.video.VideoProxyAdapter.prototype.setVideo=function(f,e){this.videoProxy.setVideo(f,e)};d.video.VideoProxyAdapter.prototype.setAsset=function(f,e){this.videoProxy.setAsset(f,e)};d.video.VideoProxyAdapter.prototype.getVolume=function(){return this.videoProxy.getVolume()};d.video.VideoProxyAdapter.prototype.setVolume=function(e){this.videoProxy.setVolume(e)};d.video.VideoProxyAdapter.prototype.mute=function(e){this.videoProxy.mute(e)};d.video.VideoProxyAdapter.prototype.muted=function(){return this.videoProxy.muted()};d.video.VideoProxyAdapter.prototype.getLoadedPosition=function(){return this.videoProxy.getLoadedPosition()};d.video.VideoProxyAdapter.prototype.getDuration=function(){return this.videoProxy.getDuration()};d.video.VideoProxyAdapter.prototype.getWidth=function(){return this.videoProxy.getWidth()};d.video.VideoProxyAdapter.prototype.getHeight=function(){return this.videoProxy.getHeight()};d.video.VideoProxyAdapter.prototype.getVideoWidth=function(){return this.videoProxy.getVideoWidth()};d.video.VideoProxyAdapter.prototype.getVideoHeight=function(){return this.videoProxy.getVideoHeight()};d.video.VideoProxyAdapter.prototype.ended=function(){return this.videoProxy.ended()};d.video.VideoProxyAdapter.prototype.supportsFullScreen=function(){return this.videoProxy.supportsFullScreen()};d.video.VideoProxyAdapter.prototype.enterFullScreen=function(){this.videoProxy.enterFullScreen()};d.video.VideoProxyAdapter.prototype.resize=function(e,f){this.videoProxy.resize(e,f)};d.video.VideoProxyAdapter.prototype.play=function(){this.videoProxy.play()};d.video.VideoProxyAdapter.prototype.paused=function(){return this.videoProxy.paused()};d.video.VideoProxyAdapter.prototype.pause=function(){this.videoProxy.pause()};d.video.VideoProxyAdapter.prototype.getCurrentTime=function(){return this.videoProxy.getCurrentTime()};d.video.VideoProxyAdapter.prototype.seek=function(e){this.videoProxy.seek(e)};d.video.VideoProxyAdapter.prototype.dispose=function(){this.videoProxy.dispose()};d.video.VideoProxyAdapter.prototype.refresh=function(){this.videoProxy.refresh()};d.video.VideoProxyAdapter.prototype.getIsProxyready=function(){return this.videoProxy.getIsProxyready()};d.video.VideoProxyAdapter.prototype.getStats=function(){return this.videoProxy.getStats&&this.videoProxy.getStats()};d.video.VideoProxyAdapter.prototype.getCurrentSrc=function(){return this.videoProxy.getCurrentSrc()};d.video.VideoProxyAdapter.prototype.isNativePlayback=function(){return this.videoProxy.isNativePlayback()};d.video.VideoProxyAdapter.prototype.onLoadProgress=function(){};d.video.VideoProxyAdapter.prototype.onCurrentTime=function(){};d.video.VideoProxyAdapter.prototype.onDuration=function(){};d.video.VideoProxyAdapter.prototype.onVideoDimension=function(){};d.video.VideoProxyAdapter.prototype.onSeeked=function(){};d.video.VideoProxyAdapter.prototype.onVolume=function(){};d.video.VideoProxyAdapter.prototype.onStateChange=function(){};d.video.VideoProxyAdapter.prototype.onBuffering=function(){};d.video.VideoProxyAdapter.prototype.onViewReady=function(){}}})(s7getCurrentNameSpace());