/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2011 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
(function(b){b.pkg("s7sdk.video");b.Util.require("s7sdk.common.ItemDesc");b.Util.require("s7sdk.common.IS");b.Util.require("s7sdk.common.IconEffect");b.Util.require("s7sdk.common.Enumeration");b.Util.require("s7sdk.common.WebVtt");b.Util.require("s7sdk.event.Event");b.Util.require("s7sdk.video.VideoProxies");b.Util.require("s7sdk.video.qosMetric");if(!b.video.playbackType){b.video.playbackType={AUTO:"auto",HLS:"hls",DASH:"dash",PROGRESSIVE:"progressive",NATIVE:"native",FLASH:"flash"}}if(!b.video.VideoPlayerControl){b.video.VideoPlayerControl=function(c){arguments.callee.superclass.apply(this,[c,b.video.VideoPlayerControl.NS,c.constructor,b.video.VideoPlayer.RESTRICTED_STYLES]);delete this.dynamicModifiers["posterimage"]};b.video.VideoPlayerControl.NS="s7sdk.video.VideoPlayerControl";b.video.VideoPlayerControl.prototype.setModifier=function(c){var e,l,f;for(var h in c){var g=h.toLowerCase();if(g=="navigation"){l=c[h];if(l){var d,j=true;f=this.component.navigation.file+","+(this.component.enableNavigation?"1":"0");var m=l.split(",");if(m&&m.length>0){d=m[0];if(m.length>1){j=parseInt(m[1])!=0}if(d&&d.length>0){this.component.setNavigation(d,j);this.dispatchEvent(new b.event.ControlComponentEvent(b.event.ControlComponentEvent.NOTF_CONTROLCOMPONENT_MODIFIERUPDATED,{id:this.component.getId(),oldvalue:f,newvalue:d+","+(j?"1":"0"),property:g},false))}else{this.component.setNavigation("",false)}}this.dynamicModifiers.set(g,l)}}else{if(g=="caption"){l=c[h];if(l){var d,j=true;f=this.component.caption.file+","+(this.component.enableCaptions?"1":"0");var m=l.split(",");if(m&&m.length>0){d=m[0];if(m.length>1){j=parseInt(m[1])!=0}if(d&&d.length>0){this.component.setCaption(d,j);this.dispatchEvent(new b.event.ControlComponentEvent(b.event.ControlComponentEvent.NOTF_CONTROLCOMPONENT_MODIFIERUPDATED,{id:this.component.getId(),oldvalue:f,newvalue:d+","+(j?"1":"0"),property:g},false))}else{this.component.setCaptionEnabled(false)}}this.dynamicModifiers.set(g,l)}}else{if(g=="interactivedata"){l=c[h];if(l){var d,j=true;f=this.component.interactiveData.file+","+(this.component.enableInteractiveData?"1":"0");var m=l.split(",");if(m&&m.length>0){d=m[0];if(m.length>1){j=parseInt(m[1])!=0}if(d&&d.length>0){this.component.setInteractiveData(d,j);this.dispatchEvent(new b.event.ControlComponentEvent(b.event.ControlComponentEvent.NOTF_CONTROLCOMPONENT_MODIFIERUPDATED,{id:this.component.getId(),oldvalue:f,newvalue:d+","+(j?"1":"0"),property:g},false))}}this.dynamicModifiers.set(g,l)}}else{if(g=="mutevolume"){l=c[h];if(l){this.component.mute()}else{this.component.unmute()}}else{if(!e){e={}}e[h]=c[h]}}}}}if(e){this.superclass.prototype.setModifier.apply(this,[e])}};b.video.VideoPlayerControl.prototype.rebuild=function(t){if(this.component){var d=this.component.getVolume();var r=this.component.muted();var f=this.component.viewReadyEventSent;var n=this.component.metadataReadyEventSent;var p=this.component.assetSpecificPosterImage;var o=t["posterimage"];t["posterimage"]=o?o:this.component.posterimage;var j=t["asset"];var c=t["video"];var l;var m=this.component.getCurrentAsset()?true:false;if(j){l=j;delete t["asset"];f=false;n=false;m=true}else{if(c){l=c;delete t["video"];f=false;n=false;m=false}else{if(m){l=this.component.getCurrentAsset()}else{l=this.component.getCurrentVideo()}}}var s,q,e;if((typeof this.component.getWidth=="function")&&(typeof this.component.getHeight=="function")){s=this.component.getWidth();q=this.component.getHeight()}var k,h;if(this.restrictedStylesValues[this.getCl()]){k=this.restrictedStylesValues[this.getCl()].width;h=this.restrictedStylesValues[this.getCl()].height}this.listenerProxy=b.Util.copyListeners(this.component);this.unload();this.component=new this.componentconstructor(this.parentId,t,this.compId,true);this.component.allowInitialUserEvent=false;this.restrictedStylesValues=this.readRestrictedStylesValues();var g=false;if(k&&h&&this.restrictedStylesValues[this.getCl()]){g=(k!=this.restrictedStylesValues[this.getCl()].width);g=g||(h!=this.restrictedStylesValues[this.getCl()].height)}if(!g&&(typeof this.component.resize=="function")){this.component.resize(s,q)}b.Util.assignListeners(this.listenerProxy,this.component);delete t["posterimage"];if(this.component.assetSpecificPosterImage){p=this.component.assetSpecificPosterImage}else{if(o&&o.toLowerCase()=="none"){p=undefined}}if(m){this.component.setCurrentAsset(l,p)}else{this.component.setCurrentVideo(l,p)}this.component.setVolume(d);if(r){this.component.mute()}else{this.component.unmute()}this.component.viewReadyEventSent=f;this.component.metadataReadyEventSent=n}}}b.Class.inherits(b.video.VideoPlayerControl.NS,"s7sdk.ControlComponent");if(!b.video.VideoPlayer){b.video.VideoPlayer=function VideoPlayer(c,e,d){var f=!!arguments[3];arguments.callee.superclass.apply(this,[d,c,"div",this.getCssClassName(),e,!f]);this.compId=(b.Util.isNull(d)?"":d);this.preparePlayer();this.completePlayer();this.setNavigationAndInteractiveData();if(!f){return new b.video.VideoPlayerControl(this)}else{return this}};b.Class.inherits("s7sdk.video.VideoPlayer","s7sdk.UIComponent");b.video.VideoPlayer.prototype.symbols={ERROR:"Your Browser does not support HTML5 Video tag or the video cannot be played."};b.video.VideoPlayer.prototype.setModifier=function(c){throw new Error("Trying to use setModifier on the Core class (VideoPlayer) is unsupported! Please refer to SDK documentation on using setModifier.")};b.video.VideoPlayer.prototype.getCssClassName=function(){return"s7videoplayer"};b.video.VideoPlayer.prototype.modifiers={serverUrl:{params:["isRootPath"],defaults:["/is/image/"]},videoServerUrl:{params:["value"],defaults:["/is/content/"]},contentUrl:{params:["value"],defaults:["/is/content/"]},size:{params:["width","height"],defaults:[0,0],ranges:["0:","0:"]},asset:{params:["value"],defaults:[""]},autoplay:{params:["enabled"],defaults:[true]},singleclick:{params:["singleclick"],defaults:["playPause"],ranges:[["none","playPause"]]},posterimage:{params:["posterimage"],defaults:[""]},iconEffect:{params:["enabled","count","fade","autoHide"],defaults:[true,1,0.3,3],ranges:[null,"-1:","0:","0:"]},playback:{params:["type","controls"],defaults:[b.video.playbackType.AUTO,false],ranges:[[b.video.playbackType.AUTO,b.video.playbackType.HLS,b.video.playbackType.DASH,b.video.playbackType.PROGRESSIVE,b.video.playbackType.NATIVE,b.video.playbackType.FLASH]]},progressivebitrate:{params:["value"],defaults:[700],ranges:["1:"]},caption:{params:["file","enabled"],defaults:["",false]},navigation:{params:["file","enabled"],defaults:["",true]},interactiveData:{params:["file","enabled"],defaults:["",true]},initialbitrate:{params:["value"],defaults:[0],ranges:["0:"]},aemmode:{params:["value"],defaults:[false],ranges:[[true,false]]},loop:{params:["enabled"],defaults:[false]},video:{params:["value"],defaults:[""],parseParams:false},ssl:{params:["value"],defaults:["auto"],ranges:[["auto","on"]],deprecated:true},waiticon:{params:["enabled"],defaults:[true]},preload:{params:["enabled"],defaults:[true]},mutevolume:{params:["enabled"],defaults:[false],ranges:[[true,false]]}};b.video.VideoPlayer.RESTRICTED_STYLES={"s7videoplayer":["width","height"],"s7videoplayer s7iconeffect":["width","height"]};b.video.VideoPlayer.prototype.preparePlayer=function(){this.createElement();this.container=this.getParent();this.videoServerUrl=b.Util.normalizeUrl(this.videoServerUrl);var c=b.browser.name==="ie"&&b.browser.version.minor===11&&this.aemmode;if(this.playback.type===b.video.playbackType.NATIVE||this.playback.type===b.video.playbackType.FLASH||c){this.playback.type=b.video.playbackType.PROGRESSIVE}if(this.video){this.playback.type=b.Util.getVideoPlaybackTypeFromUrl(this.video)}if(/(https?:\/\/[^\/]*)\b(\/DMGateway\/(private)\/)/.test(this.videoServerUrl)){this.videoServerUrl=this.videoServerUrl.replace(/(https?:\/\/[^\/]*)(\/[^\/]*)(\/private\/)/g,"$1$2/private-ssl/")}if(/(https?:\/\/[^\/]*)\b(\/DMGateway\/(public)\/)/.test(this.videoServerUrl)){this.videoServerUrl=this.videoServerUrl.replace(/(https?:)(\/\/[^\/]*)(\/[^\/]*)(\/public\/)/g,(((this.ssl=="on")||(b.browser.name=="ie"&&b.browser.version.minor==11&&(typeof(MediaSource)!="undefined")&&this.playback.type===b.video.playbackType.AUTO))?"https:$2$3/public-ssl/":location.protocol+"$2$3$4"));this.videoServerUrl=this.videoServerUrl.replace(/(https:\/\/[^\/]*)(\/[^\/]*)(\/public\/)/g,"$1$2/public-ssl/")}this.videoItem=null;this.serverDuration=undefined;this.curMilestone=undefined;this.seekTime=undefined;this.methodCallQueue=[];this.setRequestLoaded=true;this.viewReadyEventSent=false;this.metadataReadyEventSent=false;this.allowInitialUserEvent=true;this.assetSpecificPosterImage=undefined;this.endNotificationSent=false;this.videoCapabilityState=new b.VideoCapabilityState();this.wid=this.size.width;this.hei=this.size.height;if(this.wid==0||this.hei==0){this.wid=parseInt(b.Util.css.getCss(this.getCssClassName(),"width",this.compId,null,this.container));this.hei=parseInt(b.Util.css.getCss(this.getCssClassName(),"height",this.compId,null,this.container));if(!b.Util.isNumber(this.wid)||!b.Util.isNumber(this.hei)||this.wid<=0||this.hei<=0){if("clientHeight" in this.container&&"clientWidth" in this.container){this.wid=this.container.clientWidth;this.hei=this.container.clientHeight}if(this.wid==0||this.hei==0){this.wid=400;this.hei=300}}}this.obj.style.width=this.wid+"px";this.obj.style.height=this.hei+"px";this.clickToPlay=0;if((/play/i).test(this.singleclick)){this.clickToPlay=1}this.serverUrl=b.Util.normalizeUrl(this.serverUrl);this.attachToContainer()};b.video.VideoPlayer.prototype.completePlayer=function(){var d=this;this.videoProxy=this.resolveVideoProxy();this.videoQosMetric=new b.video.QosMetric(d);this.onTogglePauseHandler=function(f){if(window.MouseEvent&&f instanceof MouseEvent){d.togglePause()}};this.onClickHandler=function(f){b.Event.dispatch(d.obj,b.Event.CLICK,false)};this.onTouchEndHandler=function(f){if(window.TouchEvent&&f instanceof TouchEvent){d.ovlInTouch=true}};this.onTouchClickHandler=function(f){if(window.TouchEvent&&f instanceof TouchEvent){if(d.ovlInTouch){d.togglePause()}d.ovlInTouch=false}};if(!(this.playback.controls&&(this.playback.type===b.video.playbackType.PROGRESSIVE||this.playback.type===b.video.playbackType.AUTO))){this.divClickElement=document.createElement("div");this.obj.appendChild(this.divClickElement);this.divClickElement.style.width=this.wid+"px";this.divClickElement.style.height=this.hei+"px";this.divClickElement.style.position="absolute";this.divClickElement.style.top="0px";this.divClickElement.style.left="0px";if(b.browser.name=="ie"){this.divClickElement.style.opacity=0}}if(this.clickToPlay&&!this.hasNativeControls()&&this.divClickElement){b.Event.addDOMListener(this.divClickElement,"touchend",d.onTouchEndHandler,{passive:false});b.Event.addDOMListener(this.obj,"click",d.onTouchClickHandler,false);b.Event.addDOMListener(this.obj,"click",d.onTogglePauseHandler,false)}if(!this.hasNativeControls()){b.Event.addDOMListener(this.obj,"click",d.onClickHandler,false)}this.createIconEffect();this.createWaitIcon();var c=unescape(this.asset);if(c!=""&&this.video==""){this.setAsset(c,this.posterimage)}if(this.video!=""){this.setVideo(this.video,this.posterimage)}if(this.posterimage&&this.posterimage!=""){if(this.posterimage.indexOf("?")!=0&&this.posterimage!="none"){this.assetSpecificPosterImage=this.posterimage;this.posterimage=""}else{this.assetSpecificPosterImage=undefined}}this.addEventListener(b.event.CapabilityStateEvent.NOTF_VIDEO_CAPABILITY_STATE,function(f){d.onCapabilityState(f)});this.setCaption(this.caption.file);this.setCaptionEnabled(this.caption.enabled)};b.video.VideoPlayer.prototype.setNavigationAndInteractiveData=function(){this.setNavigation(this.navigation.file,this.navigation.enabled);this.setInteractiveData(this.interactiveData.file)};b.video.VideoPlayer.prototype.addEventListener=function(e,d,c){this.superproto.addEventListener.apply(this,[e,d,c])};b.video.VideoPlayer.prototype.getCurrentAsset=function(){return this.currentAsset};b.video.VideoPlayer.prototype.resolveSmartCropVideoProxy=function(c){return c};b.video.VideoPlayer.prototype.setCurrentAsset=function(d,c){this.assetSpecificPosterImage=c;if(typeof(d)=="string"){this.setAsset(d,c)}else{if(this.isReq_){this.isReq_.cancelHttpReq()}this.currentAsset=d;this.createViewer(d)}};b.video.VideoPlayer.prototype.getCurrentVideo=function(){return this.currentVideo};b.video.VideoPlayer.prototype.setCurrentVideo=function(d,c){this.assetSpecificPosterImage=c;if(typeof(d)=="string"){this.setVideo(d,c)}};b.video.VideoPlayer.prototype.onCapabilityState=function(c){var d=c.s7event.state;if(d.hasCapability(b.VideoCapabilityState.PAUSE)){if(this.iconEffectObj){this.iconEffectObj.hide()}this.showWaitIcon(this.videoProxy.isBuffering())}if(d.hasCapability(b.VideoCapabilityState.PLAY)){if(this.iconEffectObj){this.showWaitIcon(false);this.iconEffectObj.show(this.wid,this.hei);b.Util.css.setCSSAttributeSelector(this.iconEffectObj.obj,"state","play")}}if(d.hasCapability(b.VideoCapabilityState.REPLAY)){if(this.iconEffectObj){this.showWaitIcon(false);this.iconEffectObj.show(this.wid,this.hei);b.Util.css.setCSSAttributeSelector(this.iconEffectObj.obj,"state","replay")}}};b.video.VideoPlayer.prototype.getWidth=function(){return this.wid};b.video.VideoPlayer.prototype.getHeight=function(){return this.hei};b.video.VideoPlayer.prototype.resize=function(c,d){if(c==this.wid&&d==this.hei){return}this.wid=c>0?c:1;this.hei=d>0?d:1;this.videoProxy.resize(this.wid,this.hei);this.obj.style.width=this.wid+"px";this.obj.style.height=this.hei+"px";if(this.divClickElement){this.divClickElement.style.width=this.wid+"px";this.divClickElement.style.height=this.hei+"px"}if(this.iconEffectObj&&this.iconEffectObj.enabled){this.iconEffectObj.centerOverlay(c,d)}if(this.captionContainerDiv){this.obj.removeChild(this.captionContainerDiv);this.captionContainerDiv=undefined}b.UIComponent.prototype.resize.apply(this,[c,d]);b.Logger.log(b.Logger.INFO,"VideoPlayer.resize( %0 %1 )",c,d)};b.video.VideoPlayer.prototype.supportsInline=function(){b.Logger.log(b.Logger.INFO,"VideoPlayer.supportsInline() = %0",!((b.browser.device.name=="android"&&b.browser.device.version<4)||b.browser.device.name=="iphone"));return !((b.browser.device.name=="android"&&b.browser.device.version<4)||(b.browser.device.name=="iphone"&&b.browser.device.version<10))};b.video.VideoPlayer.prototype.getAsset=function(){var c=(this.videoItem==null?null:this.videoItem.name);b.Logger.log(b.Logger.INFO,"VideoPlayer.getAsset() = %0",c);return c};b.video.VideoPlayer.prototype.invalidateWebVttData=function(){this.captionCues=[];this.invalidateNavigation();this.invalidateInteractiveData()};b.video.VideoPlayer.prototype.setAsset=function(f,c){this.metadataReadyEventSent=false;this.viewReadyEventSent=false;this.setRequestLoaded=false;this.methodCallQueue.splice(0,this.methodCallQueue.length);this.resetQosMetric();var d=new b.event.VideoEvent(b.event.VideoEvent.NOTF_CURRENT_TIME,0,true);this.dispatchEvent(d,false);var e=new b.UserEvent(b.UserEvent.CURRENT_TIME,0,true);this.dispatchEvent(e,false);this.invalidateWebVttData();this.assetSpecificPosterImage=c;this.currentAsset=f;this.loadAsset(f);b.Logger.log(b.Logger.INFO,"VideoPlayer.setAsset( %0 )",f+(c?", "+c:""))};b.video.VideoPlayer.prototype.setVideo=function(e,c){this.metadataReadyEventSent=false;this.viewReadyEventSent=false;this.setRequestLoaded=true;this.methodCallQueue.splice(0,this.methodCallQueue.length);this.resetQosMetric();var d=new b.event.VideoEvent(b.event.VideoEvent.NOTF_CURRENT_TIME,0,true);this.dispatchEvent(d,false);var g=new b.UserEvent(b.UserEvent.CURRENT_TIME,0,true);this.dispatchEvent(g,false);this.invalidateWebVttData();this.assetSpecificPosterImage=(c=="none")?"":c;var f=b.Util.getVideoPlaybackTypeFromUrl(e);if(this.playback.type!==f){this.playback.type=f;this.videoQosMetric.dispose();this.videoProxy.dispose();this.videoProxy=this.resolveVideoProxy();this.videoQosMetric=new b.video.QosMetric(this)}this.checkRefreshVideoProxy();this.currentVideo=e;this.videoProxy.setVideo(e,this.assetSpecificPosterImage);b.Logger.log(b.Logger.INFO,"VideoPlayer.videoName( %0 )",e+(this.assetSpecificPosterImage?", "+this.assetSpecificPosterImage:""))};b.video.VideoPlayer.prototype.setCaption=function(c){this.caption.file=c;this.captionCues=[];if(b.Util.isNonEmptyString(this.caption.file)){this.loadWebVTT()}};b.video.VideoPlayer.prototype.setNavigation=function(c){var d=true;if(arguments.length>1){d=arguments[1]}this.navigation.file=c;this.enableNavigation=d;this.navigationCues=null;if(b.Util.isNonEmptyString(this.navigation.file)){this.loadNavigationWebVTT()}};b.video.VideoPlayer.prototype.setInteractiveData=function(c){var d=true;if(arguments.length>1){d=arguments[1]}this.interactiveData.file=c;this.enableInteractiveData=d;this.interactiveCues=null;this.currentInteractiveDataIndex=-1;if(b.Util.isNonEmptyString(this.interactiveData.file)){this.loadInteractiveDataWebVTT()}};b.video.VideoPlayer.prototype.loadAsset=function(c){b.Logger.log(b.Logger.INFO,"VideoPlayer.loadAsset");var d=b.Util.resolveURL(this.serverUrl,b.MediaSetParser.parseAssetForSetReq(c).req);if(b.Util.isNonEmptyString(this.locale)){d+="&locale="+this.locale}if(this.isReq_){this.isReq_.cancelHttpReq()}this.isReq_=new b.IS();this.isReq_.getHttpReq(d,function(f,e){b.video.VideoPlayer.prototype.setRequestComplete.apply(e,[f])},function(f,e){b.video.VideoPlayer.prototype.setRequestError.apply(e,[f,c])},this)};b.video.VideoPlayer.prototype.invalidateNavigation=function(){if(this.videoItem){b.Logger.log(b.Logger.INFO,"Invalidate navigation content");var c=new b.event.VideoEvent(b.event.VideoEvent.NOTF_NAVIGATION,null,true);this.dispatchEvent(c,false)}this.navigationCues=null};b.video.VideoPlayer.prototype.loadNavigationWebVTT=function(){var c;if(/^\s*http[s]?:\/\//.test(this.navigation.file)){c=this.navigation.file}else{c=b.Util.resolveURL(this.contentUrl,this.navigation.file)}c+="?req=CONTENT,json,utf-8";if(this.navigationReq){this.navigationReq.cancelHttpReq()}var d=this;this.navigationReq=new b.IS();this.navigationReq.getHttpReq(c,function(g,e){d.navigationCues=b.common.WebVtt.parse(g,b.common.WebVtt.TYPE_NAVIGATION);var h=(d.enableNavigation)?d.navigationCues:null;var f=new b.event.VideoEvent(b.event.VideoEvent.NOTF_NAVIGATION,h,true);d.dispatchEvent(f,false)},function(e){b.Logger.log(b.Logger.WARNING,"Error loading navigation file: %0",d.navigation.file)},this)};b.video.VideoPlayer.prototype.loadWebVTT=function(){var c;if(/^\s*http[s]?:\/\//.test(this.caption.file)){c=this.caption.file}else{c=b.Util.resolveURL(this.contentUrl,this.caption.file)}c+="?req=CONTENT,json,utf-8";if(this.captionReq){this.captionReq.cancelHttpReq()}var d=this;this.captionReq=new b.IS();this.captionReq.getHttpReq(c,function(g,e){var f=b.common.WebVtt.parse(g,b.common.WebVtt.TYPE_CAPTION).getItems();for(i in f){var h=f[i];e.captionCues.push({"start":h.start,"end":h.end,"caption":h.data,"settings":h.settings})}e.checkCaptions(e.getCurrentTime())},function(e){b.Logger.log(b.Logger.ERROR,"Error loading caption file: %0",d.caption.file)},this)};b.video.VideoPlayer.prototype.invalidateInteractiveData=function(){if(this.videoItem){b.Logger.log(b.Logger.INFO,"Invalidate interactive data content");var c=new b.event.VideoEvent(b.event.InteractiveDataEvent.NOTF_INTERACTIVE_DATA,null,true);this.dispatchEvent(c,false);this.interactiveDataCues=null;this.interactiveData_=null;this.globalInteractiveDataSegment=null;this.interactiveDataSegments=null}};b.video.VideoPlayer.prototype.loadInteractiveDataWebVTT=function(){var c;if(/^\s*http[s]?:\/\//.test(this.interactiveData.file)){c=this.interactiveData.file}else{c=b.Util.resolveURL(this.contentUrl,this.interactiveData.file)}c.indexOf("?")==-1?c+="?":c+="&";c+="req=CONTENT,json,utf-8";if(this.interactiveDataReq){this.interactiveDataReq.cancelHttpReq()}var d=this;this.interactiveDataReq=new b.IS();this.interactiveDataReq.getHttpReq(c,function(f,e){d.setInteractiveDataCues(b.common.WebVtt.parse(f,b.common.WebVtt.TYPE_METADATA))},function(e){b.Logger.log(b.Logger.WARNING,"Error loading interactive data file: %0",d.interactiveData.file)},this)};b.video.VideoPlayer.prototype.setInteractiveDataCues=function(l){var k=this;k.interactiveDataCues=l;k.interactiveData_=null;var j=(k.enableInteractiveData)?k.interactiveDataCues:null;if(j&&j.items){k.interactiveData_=[];k.globalInteractiveDataSegment=null;var c=-1;var d=-1;var m=-1;for(var h=0;h<j.items.length;h++){var e=Number(j.items[h].start),g=Number(j.items[h].end);if(c==-1){c=e;d=g;if(j.items[h].data.hasOwnProperty("properties")){b.Logger.log(b.Logger.FINE,"global segment: %0 --> %1",e,g);m=k.interactiveData_.length;k.globalInteractiveDataSegment=j.items[h]}}else{if(e<c){c=e}if(g>=d){d=g;if(e==c&&j.items[h].data.hasOwnProperty("properties")){b.Logger.log(b.Logger.FINE,"global segment: %0 --> %1",e,g);k.globalInteractiveDataSegment=j.items[h];m=k.interactiveData_.length}}if(k.globalInteractiveDataSegment&&(Number(k.globalInteractiveDataSegment.start)!=c||Number(k.globalInteractiveDataSegment.end)!=d)){m=-1;k.globalInteractiveDataSegment=null}}b.Logger.log(b.Logger.FINE,"Cue["+h+"]: "+j.items[h]);k.interactiveData_.push(j.items[h].data)}function n(o){j.items.splice(o,1);k.interactiveData_.splice(o,1)}if(m!=-1){b.Logger.log(b.Logger.FINE,"Remove global InteractiveData WebVTT segment[%0]",m);n(m)}for(var h=k.interactiveData_.length-1;h>=0;h--){if(!k.interactiveData_[h].swatches){b.Logger.log(b.Logger.FINE,"Remove InteractiveData WebVTT segment[%0] that does not have swatches",h);n(h)}}}k.processInteractiveData(-1);var f=new b.event.InteractiveDataEvent(b.event.InteractiveDataEvent.NOTF_INTERACTIVE_DATA,{properties:k.getInteractiveDataProperties(),interactiveData:k.getInteractiveData()},true);k.dispatchEvent(f,false)};b.video.VideoPlayer.prototype.processInteractiveData=function(f){if(f!=-1&&!f){b.Logger.log(b.Logger.SEVERE,"Invalid number of visible interactive data elements: %0",count);return}this.interactiveDataVisible=f;if(!this.interactiveDataCues){b.Logger.log(b.Logger.WARNING,"Interactive data uninitialized");return}function o(w,v){if(w&&w instanceof Object){return w[v]}return null}var l=this.interactiveDataCues;this.interactiveDataSegments=[];var h=0;var j;for(var r=0;r<l.items.length;r++){var u=l.items[r];b.Logger.log(b.Logger.INFO,"Cue["+r+"]: "+u);var m=o(o(o(u,"data"),"swatches"),"item");if(!m){b.Logger.log(b.Logger.WARNING,"Ignore InteractiveData WebVTT segment[%0] that does not have swatches",r);continue}if(f==-1||m.length<f){this.interactiveDataSegments.push({start:u.start,end:u.end,index:h})}else{var q=Math.ceil(m.length/f);var c=Number(u.end)-Number(u.start);var n=Math.ceil(c/q),e=c,d=Math.ceil(m.length/q);var t=m.length;var k=Number(u.start),g;var j=h;var s=h+m.length-f;for(var p=0;p<q;p++){if(t<=f){g=Number(u.end)}else{g=k+n}this.interactiveDataSegments.push({start:k,end:g,index:Math.min(j,s)});k=g;j+=d;e-=n;t-=d}}h+=m.length}for(var r=0;r<this.interactiveDataSegments.length;r++){b.Logger.log(b.Logger.FINE,"Interactive data segments[%0]: %1 - %2, %3",r,this.interactiveDataSegments[r].start,this.interactiveDataSegments[r].end,this.interactiveDataSegments[r].index)}};b.video.VideoPlayer.prototype.updateVisibleInterativeData=function(c){if(!c){b.Logger.log(b.Logger.SEVERE,"Invalid number of visible interactive data elements: %0",c);return}this.processInteractiveData(c)};b.video.VideoPlayer.prototype.setRequestComplete=function(d){var j=this.videoItem;var c=d.set;if(c==null){return}var g=b.MediaSetParser.parse(c,"");switch(g.type){case b.ItemDescType.VIDEO_SET:this.createViewer(g);break;case b.ItemDescType.VIDEO:this.createViewer(g.items[0]);break;case b.ItemDescType.VIDEO_GROUP:this.createViewer(g);break;default:throw new Error("parsed media set is of wrong type: "+g.type)}this.setRequestLoaded=true;while(this.methodCallQueue.length>0){var f=this.methodCallQueue[0];this.methodCallQueue.splice(0,1);this[f.func].apply(this,f.args)}if(!this.metadataReadyEventSent){var e=new b.event.StatusEvent(b.event.StatusEvent.NOTF_ASSET_METADATA_READY,true);b.Event.dispatch(this.obj,e,false);this.metadataReadyEventSent=true}if(j!=null){var h=new b.UserEvent(b.UserEvent.SWAP,[0,this.videoItem],true);this.dispatchEvent(h,false)}};b.video.VideoPlayer.prototype.createViewer=function(c){this.videoCapabilityState=new b.VideoCapabilityState();this.endNotificationSent=false;this.setAssetInternal(c);this.settings.trackLoad(this);this.checkCaptions(this.getCurrentTime());if(this.allowInitialUserEvent){if(this.autoplay){var e=new b.UserEvent(b.UserEvent.PLAY,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(e,false)}this.allowInitialUserEvent=false}var d=new b.event.AssetEvent(b.event.AssetEvent.ASSET_CHANGED,c,this.getIndexFromItem(c),true);this.dispatchEvent(d)};b.video.VideoPlayer.prototype.getIndexFromItem=function(f){if(f.parent!=null){var e=-1;var d=f.parent.items;for(var c=0;c<d.length;c++){if(d[c].name==f.name){e=c;break}}return e}else{return 0}};b.video.VideoPlayer.prototype.createIconEffect=function(){if(this.clickToPlay&&!this.hasNativeControls()){this.iconEffectObj=new b.IconEffect(this,this.iconEffect.enabled,this.iconEffect.count,this.iconEffect.fade,this.iconEffect.autoHide);if(this.autoplay){this.iconEffectObj.hide();this.showWaitIcon(this.videoProxy.isBuffering())}}};b.video.VideoPlayer.prototype.createWaitIcon=function(){if(this.waiticon){this.waitIconObj=document.createElement("div");this.waitIconObj.className="s7waiticon";this.waitIconObj.style.visibility="hidden";if(this.obj){this.obj.appendChild(this.waitIconObj)}}};b.video.VideoPlayer.prototype.hasNativeControls=function(){if((b.browser.device.name=="android"&&b.browser.device.version<4)||this.playback.controls){return true}else{return false}};b.video.VideoPlayer.prototype.setCaptionEnabled=function(c){var d=!this.enableCaptions&&c&&this.videoProxy.paused();this.enableCaptions=c;if(!this.enableCaptions){if(this.currentCaption){this.hideCaption();this.currentCaption=null}}else{if(d&&this.videoProxy){this.checkCaptions(this.videoProxy.getCurrentTime())}}};b.video.VideoPlayer.prototype.getCaptionEnabled=function(){return this.enableCaptions};b.video.VideoPlayer.prototype.checkCaptions=function(d){if(this.captionCues.length==0){return}if(!this.enableCaptions){return}var c=this.findCaption(d);if(this.currentCaption&&c&&this.currentCaption.start==c.start){return}this.currentCaption=c;if(c){this.showCaption(c.caption,c.settings)}else{this.hideCaption()}};b.video.VideoPlayer.prototype.showCaption=function(l,e){if(!this.captionContainerDiv){this.captionContainerDiv=document.createElement("div");this.captionContainerDiv.style.position="absolute";this.captionContainerDiv.style.visibility="hidden";this.captionContainerDiv.style.overflow="hidden";if(this.iconEffectObj.hiddenState_){this.obj.appendChild(this.captionContainerDiv)}else{this.obj.insertBefore(this.captionContainerDiv,this.iconEffectObj.iconEffectDiv_)}this.captionDiv=document.createElement("div");this.captionDiv.className="s7caption";this.captionDiv.style.visibility="hidden";this.captionContainerDiv.appendChild(this.captionDiv);this.captionDiv.style.position="relative";this.captionDiv.style.display="table"}else{this.captionDiv.style.visibility="hidden"}this.captionContainerDiv.style.width=this.wid+"px";this.captionDiv.innerText=l;this.captionDiv.textContent=l;var j=this.captionDiv.offsetHeight;var g=this.captionDiv.offsetWidth;var k,d,c;if(e.vertical=="rl"){k=Math.round((100-parseInt(e.lineSize))/2);this.captionContainerDiv.style.top=k+"%";this.captionContainerDiv.style.height=e.lineSize;this.captionContainerDiv.style.left=e.linePosition}else{if(e.vertical=="lr"){k=Math.round((100-parseInt(e.lineSize))/2);this.captionContainerDiv.style.top=k+"%";this.captionContainerDiv.style.height=e.lineSize;d=(100-parseInt(e.linePosition));this.captionContainerDiv.style.left=d+"%"}else{g=Math.min(Math.round(parseInt(e.lineSize)*this.wid/100),g);this.captionContainerDiv.style.width=g+"px";g=this.captionDiv.offsetWidth;d=Math.round(((parseInt(e.textPosition)/100)*this.wid)-g/2);d=d<0?0:d;if((d+g)>this.wid){d=this.wid-g}this.captionContainerDiv.style.left=d+"px";j=this.captionDiv.offsetHeight;var h=(j/this.hei)*100;if(e.linePosition){if(e.linePosition.indexOf("%")>0){var f=parseInt(e.linePosition);k=f-(h)/2;c=f+h;if(h>100){k=0}else{if(k<0){k=0}else{if(c>100){if(h>100){k=0}else{k=100-h}}}}if((h+k)>100){h=100-k}this.captionContainerDiv.style.top=k+"%"}else{this.captionContainerDiv.style.bottom=(j*(e.linePosition-1))+"px"}this.captionContainerDiv.style.height=h+"%"}else{if(h>85){this.captionContainerDiv.style.top="0"}else{this.captionContainerDiv.style.top=(85-h)+"%"}this.captionContainerDiv.style.bottom="15%"}}}if(e.vertical=="rl"){this.captionDiv.style.writingMode="tb-rl"}else{if(e.vertical=="lr"){this.captionDiv.style.writingMode="tb-rl"}}if(e.textAlign=="left"){this.captionDiv.style.textAlign="left"}else{if(e.textAlign=="right"){this.captionDiv.style.textAlign="right"}else{if(e.textAlign=="middle"){this.captionDiv.style.textAlign="center"}}}this.captionDiv.style.visibility="inherit";this.captionContainerDiv.style.visibility="inherit"};b.video.VideoPlayer.prototype.hideCaption=function(){if(this.captionContainerDiv){this.captionDiv.style.visibility="hidden";this.captionContainerDiv.visibility="hidden";this.captionDiv.innerText="";this.captionDiv.textContent=""}};b.video.VideoPlayer.prototype.findCaption=function(d){var c=b.video.VideoPlayer.findWebVttIndex(this.captionCues,d);if(c!=-1){return this.captionCues[c]}return null};b.video.VideoPlayer.findWebVttIndex=function(g,j,h){if(g){var e=0;var f=-1;for(var d=0;d<g.length;d++){var c=g[d];if(!c){continue}var k=Number(c.start);if(k<=j){if(j<=Number(c.end)){return d}if(k>e){e=k;f=d}}}if(h){return f}}return -1};b.video.VideoPlayer.prototype.getNavigation=function(){return this.navigationCues};b.video.VideoPlayer.prototype.getNavigationEnabled=function(){return this.enableNavigation};b.video.VideoPlayer.prototype.getInteractiveData=function(){return this.interactiveData_};b.video.VideoPlayer.prototype.getInteractiveDataProperties=function(){return(this.globalInteractiveDataSegment&&this.globalInteractiveDataSegment.data)?this.globalInteractiveDataSegment.data.properties:null};b.video.VideoPlayer.prototype.checkInteractiveData=function(h,g){if(!this.interactiveDataSegments||this.interactiveDataSegments.length==0){return}if(!this.enableInteractiveData){return}var f=this;var c=b.video.VideoPlayer.findWebVttIndex(this.interactiveDataSegments,h);if(c==-1&&g){var e=b.video.VideoPlayer.findWebVttIndex(this.interactiveDataSegments,h,g);if(this.currentInteractiveDataIndex!=e){this.currentInteractiveDataIndex=e;d(e)}}if(this.currentInteractiveDataIndex==c){return}this.currentInteractiveDataIndex=c;d(c);function d(j){var l=j==-1?-1:f.interactiveDataSegments[j].index;b.Logger.log(b.Logger.INFO,"Interactive segment %0, swatch %1",j,l);var k=new b.event.InteractiveDataEvent(b.event.InteractiveDataEvent.NOTF_ACTIVE_INTERACTIVE_DATA_UPDATED,l,true);f.dispatchEvent(k,false)}};b.video.VideoPlayer.prototype.getInteractiveDataEnabled=function(){return this.enableInteractiveData};b.video.VideoPlayer.prototype.resolveVideoProxy=function(){var d=this.prepareVideoProxy(false);var c=this;d.onCurrentTime=function(){var g=c.videoProxy.getCurrentTime();c.checkCaptions(g);c.checkInteractiveData(g);if(!c.endNotificationSent){c.checkTimingEvents()}c.checkState();if(!c.endNotificationSent){var e=new b.event.VideoEvent(b.event.VideoEvent.NOTF_CURRENT_TIME,c.videoProxy.getCurrentTime(),true);c.dispatchEvent(e,false);var h=new b.UserEvent(b.UserEvent.CURRENT_TIME,c.videoProxy.getCurrentTime(),true);c.dispatchEvent(h,false);if(c.pendingStopNotification){c.pendingStopNotification=false;var h=new b.UserEvent(b.UserEvent.STOP,c.videoProxy.getCurrentTime(),true);c.dispatchEvent(h,false)}if(c.videoProxy.ended()){c.endNotificationSent=true;var f=new b.event.VideoEvent(b.event.VideoEvent.NOTF_VIDEO_END,c.videoProxy.getCurrentTime(),true);c.dispatchEvent(f,false);var h=new b.UserEvent(b.event.UserEvent.PLAYBACK_COMPLETE,c.videoProxy.getCurrentTime(),true);c.dispatchEvent(h)}}};d.onDuration=function(){c.checkState();var f=new b.event.UserEvent(b.UserEvent.METADATA,["DURATION",c.videoProxy.getDuration()],true);c.dispatchEvent(f,false);var e=new b.event.VideoEvent(b.event.VideoEvent.NOTF_DURATION,c.videoProxy.getDuration(),true);c.dispatchEvent(e,false)};d.onLoadProgress=function(){c.checkState();var e=new b.event.VideoEvent(b.event.VideoEvent.NOTF_LOAD_PROGRESS,c.videoProxy.getLoadedPosition(),true);c.dispatchEvent(e,false)};d.onVolume=function(){c.checkState();var e=new b.event.VideoEvent(b.event.VideoEvent.NOTF_VOLUME,c.videoProxy.getVolume(),true);c.dispatchEvent(e,false)};d.onSeeked=function(){var g=c.videoProxy.getCurrentTime();if(g!=c.videoProxy.getDuration()){if(c.videoProxy.paused()&&c.iconEffectObj){if(c.waitIconObj){c.showWaitIcon(false)}c.iconEffectObj.show(this.wid,this.hei)}}if(g!=c.seekTime){var h=new b.event.VideoEvent(b.event.VideoEvent.NOTF_SEEK,c.videoProxy.getCurrentTime(),true);c.dispatchEvent(h,false);var f=new b.event.UserEvent(b.UserEvent.METADATA,["SEEK",c.videoProxy.getCurrentTime()],true);c.dispatchEvent(f,false)}c.seekTime=c.videoProxy.getCurrentTime();var e=new b.event.VideoEvent(b.event.VideoEvent.NOTF_CURRENT_TIME,c.seekTime,true);c.dispatchEvent(e,false);var f=new b.UserEvent(b.UserEvent.CURRENT_TIME,c.seekTime,true);c.dispatchEvent(f,false)};d.onStateChange=function(){c.checkState()};d.onViewReady=function(){if(!c.viewReadyEventSent){var e=new b.event.StatusEvent(b.event.StatusEvent.NOTF_VIEW_READY,true);b.Event.dispatch(c.obj,e,false)}c.viewReadyEventSent=true};d.onBuffering=function(e){c.showWaitIcon(e)};d.isBuffering=function(){return c.isbuffering};d.onPlaybackError=function(f){var e=f.type?"Type: "+f.type+", Details: "+f.message:f;var g=new b.UserEvent(b.event.UserEvent.PLAYBACK_ERROR,e,true);c.dispatchEvent(g);if(f.type===b.video.MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED||(!c.videoProxy.getIsProxyready()&&f.type===b.video.MediaError.MEDIA_ERR_NETWORK)){c.onManifestLoadError()}};return d};b.video.VideoPlayer.prototype.buildHTML5VideoProxy=function(c){return new b.video.HTML5VideoProxy(this.wid,this.hei,this.serverUrl,this.videoServerUrl,this.autoplay,this.playback,this.progressivebitrate,this.loop,this.preload,this.mutevolume,this.getLocalizedText("ERROR"),this.aemmode,c)};b.video.VideoPlayer.prototype.buildIphoneVideoProxy=function(c){return new b.video.IPhoneProxy(this.obj,this.wid,this.hei,this.serverUrl,this.videoServerUrl,this.autoplay,this.playback,this.progressivebitrate,this.loop,this.preload,this.mutevolume,this.getLocalizedText("ERROR"),this.aemmode,c)};b.video.VideoPlayer.prototype.buildVideojsProxy=function(c){return new b.video.VideojsProxy(this.wid,this.hei,this.serverUrl,this.videoServerUrl,this.autoplay,this.playback,this.progressivebitrate,this.initialbitrate,this.loop,this.preload,this.mutevolume,this.getLocalizedText("ERROR"),this.aemmode,c)};b.video.VideoPlayer.prototype.setRequestError=function(c){b.Logger.log(b.Logger.ERROR,"setRequestError %0",c)};b.video.VideoPlayer.prototype.setAssetInternal=function(c){this.videoItem=c;this.serverDuration=this.videoProxy.getDurationFromItem(c);this.videoProxy.serverDuration=this.serverDuration;if(!b.Util.isNull(this.serverDuration)){var d=new b.event.VideoEvent(b.event.VideoEvent.NOTF_DURATION,this.serverDuration,true);this.dispatchEvent(d,false)}this.checkRefreshVideoProxy();this.videoProxy.setAsset(c,this.videoProxy.resolvePosterUrl(this.assetSpecificPosterImage,this.posterimage,this.aemmode,c,false))};b.video.VideoPlayer.prototype.checkRefreshVideoProxy=function(){if(!this.videoProxy.firstAsset){this.videoProxy.refresh();if(this.videoProxy.getVideoElement().parentElement!=null){this.videoProxy.getVideoElement().parentElement.removeChild(this.videoProxy.getVideoElement())}this.videoProxy.createVideoElement()}this.obj.insertBefore(this.videoProxy.getVideoElement(),this.obj.firstChild)};b.video.VideoPlayer.prototype.setItem=function(d){b.Logger.log(b.Logger.INFO,"VideoPlayer.setItem( %0 )",d);if(this.isReq_){this.isReq_.cancelHttpReq()}if(!((d instanceof b.VideoDesc&&d.type==b.ItemDescType.VIDEO)||(d instanceof b.MediaSetDesc&&(d.type==b.ItemDescType.VIDEO_SET)||d.type==b.ItemDescType.VIDEO_GROUP))){throw new Error("Item must be a video!")}this.allowInitialUserEvent=true;this.currentAsset=d;if(this.asset!=""){this.assetSpecificPosterImage=undefined}var c=new b.event.VideoEvent(b.event.VideoEvent.NOTF_CURRENT_TIME,0,true);this.dispatchEvent(c,false);var e=new b.UserEvent(b.UserEvent.CURRENT_TIME,0,true);this.dispatchEvent(e,false);this.invalidateWebVttData();this.createViewer(d);this.asset="";if(!this.metadataReadyEventSent){var e=new b.event.StatusEvent(b.event.StatusEvent.NOTF_ASSET_METADATA_READY,true);b.Event.dispatch(this.obj,e,false);this.metadataReadyEventSent=true}};b.video.VideoPlayer.prototype.getVolume=function(){if(this.supportsVolumeControl()){return this.videoProxy.getVolume()}else{return 1}};b.video.VideoPlayer.prototype.setVolume=function(c){if(this.supportsVolumeControl()){this.videoProxy.setVolume(c);if(!this.videoProxy.muted()&&this.videoCapabilityState&&this.videoCapabilityState.hasCapability(b.VideoCapabilityState.UNMUTE)){var d=new b.UserEvent(b.UserEvent.UNMUTE,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(d)}if(this.videoProxy.muted()&&this.videoCapabilityState&&this.videoCapabilityState.hasCapability(b.VideoCapabilityState.MUTE)){var d=new b.UserEvent(b.UserEvent.MUTE,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(d)}this.checkState()}};b.video.VideoPlayer.prototype.getCurrentTime=function(){return this.videoProxy.getCurrentTime()};b.video.VideoPlayer.prototype.getLoadedPosition=function(){return this.videoProxy.getLoadedPosition()};b.video.VideoPlayer.prototype.getDuration=function(){if(!b.Util.isNull(this.videoProxy.getDuration())){return this.videoProxy.getDuration()}else{if(!b.Util.isNull(this.serverDuration)){return this.serverDuration}else{return undefined}}};b.video.VideoPlayer.prototype.getCapabilityState=function(){b.Logger.log(b.Logger.INFO,"VideoPlayer.getCapabilityState() = %0 ",this.videoCapabilityState);return this.videoCapabilityState};b.video.VideoPlayer.prototype.checkState=function(){var c=this.videoCapabilityState;this.videoCapabilityState=new b.VideoCapabilityState();if(this.videoProxy.paused()&&!this.videoProxy.ended()){this.videoCapabilityState.setCapability(b.VideoCapabilityState.PLAY);if(this.videoProxy.getCurrentTime()>0){this.videoCapabilityState.setCapability(b.VideoCapabilityState.STOP)}}if(!this.videoProxy.paused()&&!this.videoProxy.ended()){if(((b.browser.name=="chrome")||((b.browser.name=="safari")&&(b.browser.version.minor==6)))&&(b.browser.device.name=="desktop")&&this.divClickElement){this.divClickElement.style.opacity=0;this.divClickElement.style.opacity=1}this.videoCapabilityState.setCapability(b.VideoCapabilityState.PAUSE);this.videoCapabilityState.setCapability(b.VideoCapabilityState.STOP)}this.videoProxy.muted()?this.videoCapabilityState.setCapability(b.VideoCapabilityState.UNMUTE):this.videoCapabilityState.setCapability(b.VideoCapabilityState.MUTE);if(this.videoProxy.ended()){this.videoCapabilityState.setCapability(b.VideoCapabilityState.REPLAY)}if((c==null)||(c.state!=this.videoCapabilityState.state)){this.dispatchEvent(new b.event.CapabilityStateEvent(b.event.CapabilityStateEvent.NOTF_VIDEO_CAPABILITY_STATE,this.videoCapabilityState))}};b.video.VideoPlayer.prototype.ended=function(){return this.videoProxy.ended()};b.video.VideoPlayer.prototype.play=function(){if(!this.setRequestLoaded){this.fillMethodQueue("play");return}var c=this.videoCapabilityState&&this.videoCapabilityState.hasCapability(b.VideoCapabilityState.REPLAY);if(!this.videoProxy.ended()){this.videoProxy.play();this.currentInteractiveDataIndex=-1;var d=this.videoProxy.getCurrentTime();this.checkInteractiveData(d,true);if(!c){var e=new b.UserEvent(b.UserEvent.PLAY,d,true);this.dispatchEvent(e)}this.endNotificationSent=false}if(c){var e=new b.UserEvent(b.UserEvent.REPLAY,d,true);this.dispatchEvent(e)}};b.video.VideoPlayer.prototype.pause=function(){if(!this.setRequestLoaded){this.fillMethodQueue("pause");return}this.videoProxy.pause();if(this.videoCapabilityState&&this.videoCapabilityState.hasCapability(b.VideoCapabilityState.PAUSE)){var c=new b.UserEvent(b.UserEvent.PAUSE,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(c)}};b.video.VideoPlayer.prototype.stop=function(){if(!this.setRequestLoaded){this.fillMethodQueue("stop");return}this.videoProxy.pause();this.videoProxy.seek(0);this.pendingStopNotification=true;this.videoQosMetric.handlePlaybackComplete()};b.video.VideoPlayer.prototype.togglePause=function(){if(this.videoCapabilityState!=null){if(this.videoCapabilityState.hasCapability(b.VideoCapabilityState.PLAY)||this.videoCapabilityState.hasCapability(b.VideoCapabilityState.REPLAY)){var c=this.getDuration()-this.getCurrentTime();if(c<=1){this.seek(0)}this.play()}else{if(this.videoCapabilityState.hasCapability(b.VideoCapabilityState.PAUSE)){this.pause()}}}};b.video.VideoPlayer.prototype.seek=function(d){if(!this.setRequestLoaded){this.fillMethodQueue("seek",[d]);return}this.videoProxy.seek(d);var c=this.getCurrentTime();if(!b.Util.isNumber(c)){c=d}this.checkInteractiveData(c,true);this.endNotificationSent=false};b.video.VideoPlayer.prototype.muted=function(){if(this.supportsVolumeControl()){return this.videoProxy.muted()}else{return false}};b.video.VideoPlayer.prototype.mute=function(){if(this.supportsVolumeControl()){if(this.videoCapabilityState&&this.videoCapabilityState.hasCapability(b.VideoCapabilityState.MUTE)){var c=new b.UserEvent(b.UserEvent.MUTE,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(c)}this.videoProxy.mute(true);this.checkState()}};b.video.VideoPlayer.prototype.unmute=function(){if(this.supportsVolumeControl()){if(this.videoCapabilityState&&this.videoCapabilityState.hasCapability(b.VideoCapabilityState.UNMUTE)){var c=new b.UserEvent(b.UserEvent.UNMUTE,this.videoProxy.getCurrentTime(),true);this.dispatchEvent(c)}this.videoProxy.mute(false);this.checkState()}};b.video.VideoPlayer.prototype.checkTimingEvents=function(){var c=this.videoProxy.getDuration();if(b.Util.isNull(c)||c==0){return}var e=b.Util.isNull(this.videoProxy.getCurrentTime())?0:this.videoProxy.getCurrentTime();e=25*Math.floor((e*4)/c);if(e!=this.curMilestone){this.curMilestone=e;var d=new b.UserEvent(b.UserEvent.MILESTONE,this.curMilestone,true);this.dispatchEvent(d,false)}};b.video.VideoPlayer.prototype.fillMethodQueue=function(d,c){this.methodCallQueue.push({func:d,args:c})};b.video.VideoPlayer.prototype.prepareVideoProxy=function(d){if(b.browser.device.name=="iphone"){return this.buildIphoneVideoProxy(d)}var c=/^((http|https):\/\/[^\/]*)\b(\/DMGateway\/(private-ssl|private)\/)/.test(this.videoServerUrl);var f=this.isStreamingPlaybackType(this.playback.type);var g=f&&!c&&typeof(MediaSource)!=="undefined";var e="safari"===b.browser.name||"ipad"===b.browser.device.name;if(g&&!e){return this.buildVideojsProxy(d)}return this.buildHTML5VideoProxy(d)};b.video.VideoPlayer.prototype.supportsVolumeControl=function(){var c=true;if(("ipad"==b.browser.device.name)||("iphone"==b.browser.device.name)||("android"==b.browser.device.name)){c=false}return c};b.video.VideoPlayer.prototype.setCSS=function(e,d,c){if(this.isRestrictedCSSProperty(b.video.VideoPlayer.RESTRICTED_STYLES,d)){throw new Error("You cannot set "+e+" : "+d+" CSS property for this component ")}else{this.superproto.setCSS.apply(this,[e,d,c])}};b.video.VideoPlayer.prototype.dispose=function(){this.cleanUp();if(this.obj){if(this.obj.parentElement){this.obj.parentElement.removeChild(this.obj)}}};b.video.VideoPlayer.prototype.cleanUp=function(){if(this.isReq_){this.isReq_.cancelHttpReq();this.isReq_=null}if(this.navigationReq){this.navigationReq.cancelHttpReq();this.navigationReq=null}if(this.captionReq){this.captionReq.cancelHttpReq();this.captionReq=null}if(this.interactiveDataReq){this.interactiveDataReq.cancelHttpReq();this.interactiveDataReq=null}this.methodCallQueue.splice(0,this.methodCallQueue.length);if(this.iconEffectObj){this.iconEffectObj.dispose();this.iconEffectObj=null}if(this.videoQosMetric){this.videoQosMetric.dispose()}if(this.videoProxy){this.videoProxy.dispose()}if(this.obj){b.Event.removeDOMListener(this.obj,"click",this.onClickHandler,false);b.Event.removeDOMListener(this.obj,"click",this.onTogglePauseHandler,false);b.Event.removeDOMListener(this.obj,"touchend",this.onTouchEndHandler,{passive:false});b.Event.removeDOMListener(this.obj,"click",this.onTouchClickHandler,false)}b.Util.removeTags(this.obj);this.obj.style.cssText=""};b.video.VideoPlayer.prototype.showWaitIcon=function(c){if(this.waitIconObj){this.waitIconObj.style.visibility=c?"inherit":"hidden"}};b.video.VideoPlayer.prototype.onManifestLoadError=function(){var c=this.isStreamingPlaybackType(this.playback.type);if(!c||!this.currentAsset){return}this.videoQosMetric.dispose();this.videoProxy.dispose();this.playback.type=b.video.playbackType.PROGRESSIVE;this.videoProxy=this.resolveVideoProxy();this.videoQosMetric=new b.video.QosMetric(this);this.checkRefreshVideoProxy();this.videoProxy.setAsset(this.currentAsset,this.videoProxy.resolvePosterUrl(this.assetSpecificPosterImage,this.posterimage,this.aemmode,this.currentAsset,false))};b.video.VideoPlayer.prototype.isStreamingPlaybackType=function(c){return c===b.video.playbackType.AUTO||c===b.video.playbackType.HLS||c===b.video.playbackType.DASH};b.video.VideoPlayer.prototype.resetQosMetric=function(){if(this.videoQosMetric){this.videoQosMetric.reset()}};b.VideoPlayer=b.video.VideoPlayer;(function a(){var f=b.Util.css.createCssRuleText;var e=b.Util.css.createCssImgUrlText;var d=b.browser&&b.browser.name=="ie"&&b.browser.version.major>=10;var c=f(".s7videoplayer",{"position":"absolute","width":"400px","height":"300px","background-color":"#000000","-webkit-touch-callout":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","touch-action":d?"none":""})+f(".s7videoplayer div[role='button']",{"position":"relative","z-index":"1"})+f(".s7videoplayer .s7iconeffect",{"width":"120px","height":"120px","-webkit-transform":"translateZ(0px)","background-repeat":"no-repeat","background-position":"center"})+f(".s7videoplayer .s7iconeffect[state='play']",{"background-image":e("videoplayicon.png")})+f(".s7videoplayer .s7iconeffect[state='replay']",{"background-image":e("videoreplayicon.png")})+f(".s7videoplayer .s7videoposter",{"top":"0px","left":"0px","position":"absolute","background-repeat":"no-repeat","background-position":"center center","background-size":"contain"})+f(".s7videoplayer .s7caption",{"font-family":"sans-serif","font-size":"large","color":"#ffffff","-webkit-transform":"translateZ(0px)","margin":"0 auto"})+f(".s7videoplayer .s7waiticon",{"background-image":e("busyicon.gif"),"background-repeat":"no-repeat","background-position":"center","position":"absolute","width":"101px","height":"29px","left":"50%","top":"50%","margin-left":"-50px","margin-top":"-15px"});b.Util.css.addDefaultCSS(c,"VideoPlayer")})()}})(s7getCurrentNameSpace());